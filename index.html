<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vocabulari Cient√≠fic i Mediambiental (5√®me SEGPA)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Configuraci√≥ de Tailwind per a una millor visualitzaci√≥ */
        :root {
            --color-primary: #0077b6; /* Blau fosc per elements principals */
            --color-secondary: #00b4d8; /* Blau clar per destacar */
            --color-success: #4ade80; /* Verd */
            --color-error: #f87171; /* Vermell */
            --color-text-dark: #1f2937;
            --color-text-light: #f9fafb;
        }

        /* Utilitzem una font clara i de f√†cil lectura */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8; /* Fons clar */
        }
        
        /* Estil b√†sic del contenidor per centrar */
        .container-quiz {
            max-width: 768px;
            margin: auto;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 1rem;
        }

        /* Estil per a les opcions de resposta */
        .option-button {
            transition: all 0.2s ease-in-out;
            cursor: pointer;
            padding: 1.25rem; /* Augmentem el padding per millorar l'est√®tica i el tacte */
            margin-bottom: 1rem; /* Marge consistent entre botons */
            border-radius: 0.75rem;
            font-size: 1.5rem; /* Lletra gran */
            text-align: left;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.06);
            border: 2px solid #e5e7eb;
            background-color: white;
            color: var(--color-text-dark);
        }

        /* Estats de la resposta */
        .option-correct {
            background-color: var(--color-success) !important;
            border-color: var(--color-success) !important;
            color: var(--color-text-light) !important;
        }

        .option-incorrect {
            background-color: var(--color-error) !important;
            border-color: var(--color-error) !important;
            color: var(--color-text-light) !important;
        }

        .option-unselected {
            opacity: 0.5; /* Atenua les opcions no seleccionades despr√©s de respondre */
        }
        
        /* Animaci√≥ senzilla per al missatge de feedback */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        #feedback-area {
            animation: fadeIn 0.3s ease-out;
        }
    </style>
</head>
<body>

    <!-- Contenidor principal de l'aplicaci√≥ -->
    <div class="container-quiz">
        
        <!-- Targeta principal del test -->
        <div id="quiz-card" class="bg-white p-6 md:p-10 rounded-xl shadow-2xl border-t-8 border-indigo-600 w-full">
            
            <h1 class="text-3xl md:text-4xl font-extrabold text-indigo-800 mb-6 text-center">
                Test de Vocabulari üßë‚Äçüî¨üå≥
            </h1>
            
            <!-- √Ärea de la pregunta -->
            <div id="question-area" class="mb-8">
                <p id="question-number" class="text-xl font-semibold text-gray-600 mb-3"></p>
                <h2 id="question-text" class="text-2xl md:text-3xl font-bold text-gray-800 leading-snug">
                    Carregant pregunta...
                </h2>
            </div>
            
            <!-- √Ärea de les opcions de resposta -->
            <!-- S'elimina la classe 'space-y-4' per dependre nom√©s del margin-bottom dels botons. -->
            <div id="options-container">
                <!-- Les opcions es generen aqu√≠ amb JS -->
            </div>
            
            <!-- √Ärea de Feedback/Missatge -->
            <div id="feedback-area" class="mt-8 p-4 md:p-6 rounded-lg text-center font-bold text-2xl md:text-3xl hidden">
                <!-- El missatge de correcci√≥ o "Seg√ºent" es mostra aqu√≠ -->
            </div>
            
            <!-- Bot√≥ per avan√ßar, inicialment ocult -->
            <button id="next-button" class="mt-8 w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-xl text-xl shadow-lg transform transition duration-150 ease-in-out scale-100 hover:scale-[1.01] hidden" onclick="nextQuestion()">
                Seg√ºent Pregunta (Feu clic aqu√≠)
            </button>
            
        </div>

    </div>

    <script>
        // Utilitzem un objecte per tenir les dades clares i organitzades.
        const questions = [
            { q: "Qu√® √©s un dec√†metre?", options: ["Una eina per tallar arbres", "Un ocell que viu al riu", "Una cinta llarga per mesurar", "Un tub per agafar aigua"], correct: 2 },
            { q: "Qu√® √©s un cordill?", options: ["Un animal petit del riu", "Un tros de corda prima", "Una pedra rodona", "Una bota de muntanya"], correct: 1 },
            { q: "Qu√® √©s un esparver (al projecte)?", options: ["Un fil rod√≥ per pescar o agafar coses al riu", "Una eina per tallar terra", "Un ocell petit", "Un barret per a la pluja"], correct: 0 },
            { q: "Un lloc ombr√≠vol √©s...", options: ["Amb molta llum", "Tapat, amb ombra", "Molt fred", "Al costat del mar"], correct: 1 },
            { q: "Un lloc assolellat √©s...", options: ["On fa fred", "Amb ombra", "Amb molta llum del sol", "Amb neu"], correct: 2 },
            { q: "Qu√® √©s una riba?", options: ["Una roca", "El costat d‚Äôun riu", "Un animal", "Una planta"], correct: 1 },
            { q: "Una riba consolidada vol dir...", options: ["Amb molta aigua", "Amb blocs o murs per protegir-la", "Amb arbres", "Amb vegetaci√≥ natural"], correct: 1 },
            { q: "Una riba segura √©s...", options: ["On no hi ha cap perill", "On hi ha molts peixos", "On es pesca", "Amb escales"], correct: 0 },
            { q: "El curs de l‚Äôaigua √©s...", options: ["L‚Äôaigua parada", "El cam√≠ per on passa el riu", "L‚Äôal√ßada del riu", "L‚Äôaigua del mar"], correct: 1 },
            { q: "El corrent d‚Äôaigua √©s...", options: ["Aigua en moviment", "Aigua congelada", "Aigua sense vida", "Una font"], correct: 0 },
            { q: "El llit del riu √©s...", options: ["Un llit per dormir a la vora del riu", "El fons per on corre l‚Äôaigua", "El lloc on hi ha vegetaci√≥", "El lloc dels peixos"], correct: 1 },
            { q: "La vegetaci√≥ √©s...", options: ["Les pedres", "Els animals del riu", "Les plantes i arbres", "Les fulles mortes"], correct: 2 },
            { q: "La sorra √©s...", options: ["Aigua molt bruta", "Terra molt fina", "Una roca gran", "Una planta"], correct: 1 },
            { q: "La graveta √©s...", options: ["Sorra fina", "Pedres petites", "Aigua neta", "Una eina"], correct: 1 },
            { q: "Un guijarro √©s...", options: ["Un animal", "Una pedra petita i rodona", "Una planta d‚Äôaigua", "Un insecte"], correct: 1 },
            { q: "Un c√≤dol gran √©s...", options: ["Una pedra grossa i arrodonida", "Una fulla d‚Äôarbre", "Un ocell", "Una fusta"], correct: 0 },
            { q: "Una escullera √©s...", options: ["Una planta de ribera", "Un lloc per seure", "Un mur de pedres grans per protegir", "Una eina de mesura"], correct: 2 },
            { q: "Un mur de formig√≥ √©s...", options: ["Vegetaci√≥ de riu", "Una construcci√≥ dura per canalitzar el riu", "Un animal del bosc", "D. Una barca"], correct: 1 },
            { q: "El cabal del riu √©s...", options: ["La velocitat del vent", "El nombre de pedres", "La quantitat d‚Äôaigua que baixa", "El soroll que fa"], correct: 2 },
            { q: "La terbolesa de l‚Äôaigua √©s...", options: ["L‚Äôaigua molt neta", "L‚Äôaigua amb fang o brut√≠cia", "L‚Äôaigua amb sal", "L‚Äôaigua amb gel"], correct: 1 },
            { q: "El pH mesura...", options: ["El fred de l‚Äôaigua", "Si l‚Äôaigua √©s √†cida o no", "Si hi ha sorra", "El nombre de peixos"], correct: 1 },
            { q: "La contaminaci√≥ √©s...", options: ["Aigua neta", "B. Aigua freda", "Aigua bruta per acci√≥ humana", "Aigua d‚Äôun llac"], correct: 2 },
            { q: "La temperatura √©s...", options: ["El nivell de sorra", "El color de l‚Äôaigua", "El fred o calor de l‚Äôaigua o l‚Äôaire", "El cabal del riu"], correct: 2 },
            { q: "L‚Äôescorrentia √©s...", options: ["L‚Äôaigua que es filtra", "L‚Äôaigua que rellisca per la terra cap al riu", "L‚Äôaigua que puja", "L‚Äôaigua del mar"], correct: 1 },
            { q: "L‚Äôerosi√≥ √©s...", options: ["El creixement d‚Äôarbres", "Quan la terra es desf√† pel vent o l‚Äôaigua", "L‚Äôaigua freda", "Quan neva"], correct: 1 },
            { q: "Una avinguda d‚Äôun riu √©s...", options: ["Un carrer proper al riu", "Quan el riu creix molt i s‚Äôomple", "Quan el riu est√† sec", "Quan hi ha fang"], correct: 1 },
            { q: "El desgel √©s...", options: ["Quan l‚Äôaigua es fa gel", "Quan es fon la neu i baixa cap al riu", "Quan neva molt", "Quan plou molt"], correct: 1 },
            { q: "El s√≤l √©s...", options: ["El vent", "L‚Äôaigua del mar", "La terra que trepitgem o hi ha al costat del riu", "Una roca"], correct: 2 },
        ];
        
        // Estats de l'aplicaci√≥
        let currentQuestionIndex = 0;
        let isAnswered = false; // Controla si la pregunta ja s'ha respost
        
        // --- Configuraci√≥ de Firebase (Sense emmagatzematge de dades) ---
        // S'inclou per a la compatibilitat amb l'entorn de Canvas, tot i que no s'utilitza Firestore.
        let app, db, auth;
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : null;
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
        // -----------------------------------------------------------------

        // Refer√®ncies a elements del DOM
        const questionNumberEl = document.getElementById('question-number');
        const questionTextEl = document.getElementById('question-text');
        const optionsContainerEl = document.getElementById('options-container');
        const feedbackAreaEl = document.getElementById('feedback-area');
        const nextButtonEl = document.getElementById('next-button');

        /**
         * Funci√≥ per barrejar un array (algorisme de Fisher-Yates).
         * @param {Array<any>} array - L'array a barrejar.
         */
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                // Intercanvia els elements i i j
                [array[i], array[j]] = [array[j], array[i]];
            }
        }


        /**
         * Renderitza la pregunta actual i les seves opcions de forma aleat√≤ria.
         */
        function renderQuestion() {
            if (currentQuestionIndex >= questions.length) {
                showQuizEnd();
                return;
            }

            const currentQ = questions[currentQuestionIndex];
            
            // Neteja l'estat anterior
            isAnswered = false;
            optionsContainerEl.innerHTML = '';
            feedbackAreaEl.classList.add('hidden');
            nextButtonEl.classList.add('hidden');
            
            // 1. Prepara les opcions i marca la correcta
            const optionsData = currentQ.options.map((text, index) => ({
                text: text,
                isCorrect: index === currentQ.correct // Aquesta √©s la clau de correcci√≥
            }));
            
            // 2. Barreja les opcions per a una visualitzaci√≥ aleat√≤ria
            shuffleArray(optionsData);

            // Actualitza el text de la pregunta
            questionNumberEl.textContent = `Pregunta ${currentQuestionIndex + 1} de ${questions.length}`;
            questionTextEl.textContent = currentQ.q;

            // 3. Crea els botons d'opci√≥
            optionsData.forEach((option) => {
                const button = document.createElement('button');
                // Utilitza un data-attribute per emmagatzemar la correcci√≥ (true/false)
                button.setAttribute('data-is-correct', option.isCorrect); 
                button.className = 'option-button w-full hover:bg-gray-100 focus:outline-none focus:ring-4 focus:ring-indigo-300';
                button.innerHTML = option.text; // Text net
                // La funci√≥ de clic ara nom√©s necessita l'esdeveniment
                button.onclick = (event) => checkAnswer(event); 
                optionsContainerEl.appendChild(button);
            });
        }

        /**
         * Comprova si la resposta seleccionada √©s correcta o incorrecta.
         * @param {Event} event - L'esdeveniment de clic.
         */
        function checkAnswer(event) {
            if (isAnswered) {
                // Si ja s'ha respost, el clic es considera una petici√≥ per avan√ßar.
                nextQuestion();
                return;
            }

            isAnswered = true;
            const selectedButton = event.currentTarget;
            const isSelectedCorrect = selectedButton.getAttribute('data-is-correct') === 'true';
            const optionButtons = optionsContainerEl.querySelectorAll('.option-button');
            let feedbackMessage = '';
            let correctOptionText = ''; // Per guardar el text de la resposta correcta

            // 1. Aplica estils i desa el feedback
            optionButtons.forEach((btn) => {
                const isCorrect = btn.getAttribute('data-is-correct') === 'true';
                
                if (isCorrect) {
                    btn.classList.add('option-correct');
                    correctOptionText = btn.textContent.trim();
                } else if (btn !== selectedButton) {
                    // Atenua les opcions no seleccionades i incorrectes
                    btn.classList.add('option-unselected');
                }
            });

            // 2. Tracta la resposta seleccionada
            if (isSelectedCorrect) {
                // Resposta Correcta
                selectedButton.classList.remove('option-unselected');
                selectedButton.classList.add('option-correct');
                feedbackMessage = "‚úÖ CORRECTE! Molt b√©.";
                feedbackAreaEl.style.backgroundColor = 'var(--color-success)';
                feedbackAreaEl.style.color = 'var(--color-text-light)';
            } else {
                // Resposta Incorrecta
                selectedButton.classList.remove('option-unselected');
                selectedButton.classList.add('option-incorrect');
                
                // Utilitza el text de la resposta correcta que hem capturat abans
                feedbackMessage = `‚ùå ERROR. La resposta correcta √©s: ${correctOptionText}`;
                
                feedbackAreaEl.style.backgroundColor = 'var(--color-error)';
                feedbackAreaEl.style.color = 'var(--color-text-light)';
            }
            
            // 3. Deshabilita els clics a les opcions (nom√©s el clic al bot√≥ Next/Feedback avan√ßa)
            optionButtons.forEach(btn => btn.onclick = (e) => checkAnswer(e));

            // 4. Mostra el feedback i el bot√≥ "Seg√ºent"
            feedbackAreaEl.textContent = feedbackMessage;
            feedbackAreaEl.classList.remove('hidden');
            nextButtonEl.classList.remove('hidden');
        }

        /**
         * Avan√ßa a la seg√ºent pregunta.
         */
        function nextQuestion() {
            currentQuestionIndex++;
            renderQuestion();
        }

        /**
         * Mostra el missatge de finalitzaci√≥ del test.
         */
        function showQuizEnd() {
            questionNumberEl.textContent = '';
            questionTextEl.textContent = "ü•≥ TEST FINALITZAT!";
            optionsContainerEl.innerHTML = `
                <div class="p-6 bg-yellow-100 text-yellow-800 rounded-lg text-xl md:text-2xl text-center font-semibold">
                    Has arribat al final del test. La correcci√≥ es far√† manualment despr√©s.
                    <br><br>
                    Pots recarregar la p√†gina per tornar a comen√ßar.
                </div>
            `;
            feedbackAreaEl.classList.add('hidden');
            nextButtonEl.classList.add('hidden');
        }

        // --- Inicialitzaci√≥ de l'aplicaci√≥ ---
        window.onload = function() {
            // Inicialitza la primera pregunta en carregar la p√†gina
            renderQuestion();
        }
        
    </script>
</body>
</html>
